
<!DOCTYPE html>
<html lang="en" xml:lang="en">
<head>
    <meta charset="utf-8">
  <meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>Synchronization of Concurrent Execution</title>

  

  
    <link rel="index" title="Index" href="genindex.html"/>
    <link rel="top" title="CODESYS LibDevSummary V3.5.21.0 (Draft)" href="index.html"/>
    <link rel="up" title="Advanced Topicâs" href="advanced.html"/> 

<meta property="og:type" content="article">
<meta property="og:title" content="CODESYS Group">
<meta property="og:image" content="https://www.codesys.com/typo3conf/ext/template87/Resources/Public/Images/Og/CODESYS-default.jpg" />
<meta property="og:image:width" content="1200" />
<meta property="og:image:height" content="628" />
<meta name="geo.region" content="Kempten" />
<meta name="geo.country" content="Germany" />
<meta name="geo.placename" content="Memminger Stra&szlig;e 151, 87439 Kempten" />
<meta name="geo.position" content="47.321;10.573" />
<meta name="ICBM" content="47.321;10.573" />
<meta name="robots" content="index, follow, noarchive">

<link rel="shortcut icon" href="https://www.codesys.com/typo3conf/ext/template87/Resources/Public/Images/Icons/favicon.ico" type="image/x-icon; charset=binary">
<link rel="icon" href="https://www.codesys.com/typo3conf/ext/template87/Resources/Public/Images/Icons/favicon.ico" type="image/x-icon; charset=binary">
<link href="https://www.codesys.com/typo3conf/ext/template87/Resources/Public/Components/material-design-iconic-font/dist/css/material-design-iconic-font.min.css" rel="stylesheet">
<link href="https://www.codesys.com/typo3conf/ext/template87/Resources/Public/Components/LESS/helpme.min.css" rel="stylesheet">
<link href="https://www.codesys.com/typo3conf/ext/template87/Resources/Public/Components/LESS/helpme_library.min.css" rel="stylesheet">
<link href="https://www.codesys.com/typo3conf/ext/template87/Resources/Public/Components/LESS/microsite.min.css" rel="stylesheet">

<script src="https://www.codesys.com/typo3conf/ext/template87/Resources/Public/JavaScripts/jquery-2.1.4.min.js" type="text/javascript"></script>
<script src="https://www.codesys.com/typo3conf/ext/template87/Resources/Public/JavaScripts/bootstrap.min.js" type="text/javascript"></script>
<script src="https://www.codesys.com/typo3conf/ext/solr/Resources/Public/JavaScript/JQuery/jquery.autocomplete.min.js" type="text/javascript"></script>
<script src="https://www.codesys.com/typo3conf/ext/template87/Resources/Public/JavaScripts/jquery.focuspoint.min.js" type="text/javascript"></script>
<script src="https://www.codesys.com/typo3conf/ext/template87/Resources/Public/JavaScripts/jquery.waypoints.min.js" type="text/javascript"></script>
<script src="https://www.codesys.com/typo3conf/ext/template87/Resources/Public/JavaScripts/helpME.js" type="text/javascript"></script>
<script src="https://www.codesys.com/typo3conf/ext/template87/Resources/Public/JavaScripts/custom.js" type="text/javascript"></script>
<script src="https://www.codesys.com/typo3conf/ext/template87/Resources/Public/JavaScripts/suggest_controller.js" type="text/javascript"></script>
</head>

<body class="wy-body-for-nav" role="document">
<header class="affix-top" id="headerWrapper">
    <div class="container">
        <div id="logoWrapper">
            <figure>
                <a href="/en/" target="_top">
                    <img alt="CODESYS GmbH" src="https://www.codesys.com/typo3conf/ext/template87/Resources/Public/Images/CODESYS-online-help-Logo.png">
                </a>
            </figure>
        </div>
        <div class="languageDropdownWrapper" id="wrapperlangMenuDesktop">
            <button aria-expanded="false" aria-haspopup="true" class="dropdown-toggle btn" data-toggle="dropdown" id="dropdownTogglelangMenuDesktop" type="button">
                <span id="LangID"></span>
                <span class="caret"></span>
            </button>
            <ul aria-labelledby="dropdownTogglelangMenuDesktop" class="dropdown-menu dropdownContentlangMenuDesktop">
                <li class="">
                    <a class="changeLangButton" href="#" hreflang="de">Deutsch</a>
                </li>
                <li class="">
                    <a class="changeLangButton" href="#" hreflang="en">English</a>
                </li>
                <li class="">
                    <a class="changeLangButton" href="#" hreflang="fr">Fran&ccedil;ais</a>
                </li>
                <li class="">
                    <a class="changeLangButton" href="#" hreflang="es">Espa&ntilde;ol</a>
                </li>
                <li class="">
                    <a class="changeLangButton" href="#" hreflang="it">Italiano</a>
                </li>
                <li class="">
                    <a class="changeLangButton" href="#" hreflang="ru">&#1056;&#1091;&#1089;&#1089;&#1082;&#1080;&#1081;</a>
                </li>
                <li class="">
                    <a class="changeLangButton" href="#" hreflang="ja">&#26085;&#26412;&#35486;</a>
                </li>
                <li class="">
                    <a class="changeLangButton" href="#" hreflang="zh-CHS">&#20013;&#25991;</a>
                </li>
            </ul>
        </div>
        <div class="" id="menuToggle">
            <span class="toggle-icon">
                <i class="zmdi zmdi-hc-2x zmdi-menu"></i>
            </span>
            <span class="toggle-label">Menu</span>
        </div>
        <div id="searchToggle">
            <span class="toggle-icon">
                <i class="zmdi zmdi-search zmdi-hc-2x"></i>
            </span>
            <span class="toggle-label">Search</span>
        </div>
        <div class="" id="siteSearch" style="display: none;">
            <form accept-charset="utf-8" action="https://www.helpme-codesys.com/search.html" class=""
                  data-suggest="https://www.helpme-codesys.com/?type=7384" data-suggest-header="Top Results"
                  enctype="multipart/form-data" method="get" name="searchbox">
                <div class="tx-indexedsearch-hidden-fields">
                    <input name="id" type="hidden" value="">
                </div>
                <div class="input-group">
                    <input autocomplete="off"
                           class="tx-solr-q js-solr-q tx-solr-suggest tx-solr-suggest-focus form-control"
                           name="tx_solr[q]"
                           placeholder="Search term" style="position: relative;" type="text">
                </div>
            </form>
        </div>
    </div>
    <nav id="mainMenuWrapper">
        <div id="mainNav">
            <div class="menu-layout-1 inactive" id="menuFlyout" style="height: 0px;">
                <div class="languageDropdownWrapper" id="wrapperlangMenuMobile">
                    <button aria-expanded="true" aria-haspopup="true" class="dropdown-toggle btn"
                            data-toggle="dropdown" id="dropdownTogglelangMenuMobile" type="button">
                        <span id="langIDMobile"></span>
                        <span class="caret"></span>
                    </button>
                    <ul aria-labelledby="dropdownTogglelangMenuMobile"
                        class="dropdown-menu dropdownContentlangMenuMobile">
                        <li class="">
                            <a class="changeLangButton" href="#" hreflang="de">Deutsch</a>
                        </li>
                        <li class="">
                            <a class="changeLangButton" href="#" hreflang="en">English</a>
                        </li>
                        <li class="">
                            <a class="changeLangButton" href="#" hreflang="fr">Fran&ccedil;ais</a>
                        </li>
                        <li class="">
                            <a class="changeLangButton" href="#" hreflang="es">Espa&ntilde;ol</a>
                        </li>
                        <li class="">
                            <a class="changeLangButton" href="#" hreflang="it">Italiano</a>
                        </li>
                        <li class="">
                            <a class="changeLangButton" href="#" hreflang="ru">&#1056;&#1091;&#1089;&#1089;&#1082;&#1080;&#1081;</a>
                        </li>
                        <li class="">
                            <a class="changeLangButton" href="#" hreflang="ja">&#26085;&#26412;&#35486;</a>
                        </li>
                        <li class="">
                            <a class="changeLangButton" href="#" hreflang="zh-CHS">&#20013;&#25991;</a>
                        </li>
                    </ul>
                </div>
                <div class="container">
                    <div class="menu-main">
                        <div id="menuRenderContainer" class="flex-menu">
                            <!-- ############### START Automatic Menu Rendering ################## -->
                            <!-- ############### END Automatic Menu Rendering ################## -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </nav>
</header> 

    <div class="wy-grid-for-nav">

        
        <nav data-toggle="wy-nav-shift" class="wy-nav-side">
            <div class="wy-side-scroll">
                <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <p class="caption" role="heading"><span class="caption-text">Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="concepts.html">Concepts and Elements</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="library_types.html">Library Types</a><ul>
<li class="toctree-l3"><a class="reference internal" href="library_types.html#common-libraries">Common Libraries</a></li>
<li class="toctree-l3"><a class="reference internal" href="library_types.html#container-libraries">Container Libraries</a></li>
<li class="toctree-l3"><a class="reference internal" href="library_types.html#interface-libraries">Interface Libraries</a></li>
<li class="toctree-l3"><a class="reference internal" href="library_types.html#end-user-libraries">End-User Libraries</a><ul>
<li class="toctree-l4"><a class="reference internal" href="lib_changes.html">How to change a library</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="placeholder.html">Placeholder</a></li>
<li class="toctree-l2"><a class="reference internal" href="prefix.html">Library Prefix</a></li>
<li class="toctree-l2"><a class="reference internal" href="categories.html">Library Categories</a></li>
<li class="toctree-l2"><a class="reference internal" href="properties.html">Library Properties</a></li>
<li class="toctree-l2"><a class="reference internal" href="behaviour_model.html">Behaviour Model and Interface Design</a><ul>
<li class="toctree-l3"><a class="reference internal" href="behaviour_model.html#edge-triggered-function-blocks">Edge Triggered Function Blocks</a></li>
<li class="toctree-l3"><a class="reference internal" href="behaviour_model.html#level-controlled-function-blocks">Level Controlled Function Blocks</a></li>
<li class="toctree-l3"><a class="reference internal" href="behaviour_model.html#common-properties">Common properties</a></li>
<li class="toctree-l3"><a class="reference internal" href="behaviour_model.html#timing-constraints">Timing constraints</a></li>
<li class="toctree-l3"><a class="reference internal" href="behaviour_model.html#error-handling">Error Handling</a></li>
<li class="toctree-l3"><a class="reference internal" href="behaviour_model.html#sorting-inputs-and-outputs">Sorting Inputs and Outputs</a></li>
<li class="toctree-l3"><a class="reference internal" href="behaviour_model.html#cooperation">Cooperation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="behaviour_model.html#tcp-reader-example">TCP Reader Example</a></li>
<li class="toctree-l4"><a class="reference internal" href="behaviour_model.html#extending-the-example-to-a-complete-echoserver">Extending the Example to a Complete EchoServer</a></li>
<li class="toctree-l4"><a class="reference internal" href="behaviour_model.html#transformation-to-a-multithreaded-echoserver">Transformation to a Multithreaded EchoServer</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="behaviour_model.html#library-support">Library Support</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="static_analysis.html">Static Analysis</a><ul>
<li class="toctree-l3"><a class="reference internal" href="static_analysis.html#plcopen-coding-guidelines">PLCopen - Coding Guidelines</a></li>
<li class="toctree-l3"><a class="reference internal" href="static_analysis.html#recommended-rules-for-static-analysis">Recommended Rules for Static Analysis</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="var_input_constant.html">Parameterization with parameter lists</a><ul>
<li class="toctree-l3"><a class="reference internal" href="var_input_constant.html#library-parameters">Library parameters</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="var_input_constant.html#declarative-parameterization-of-function-blocks">Declarative Parameterization of Function Blocks</a></li>
<li class="toctree-l2"><a class="reference internal" href="parameters.html">Parameter Handling</a><ul>
<li class="toctree-l3"><a class="reference internal" href="parameters.html#var-input">VAR_INPUT</a></li>
<li class="toctree-l3"><a class="reference internal" href="parameters.html#var-input-constant">VAR_INPUT CONSTANT</a></li>
<li class="toctree-l3"><a class="reference internal" href="parameters.html#var-output">VAR_OUTPUT</a></li>
<li class="toctree-l3"><a class="reference internal" href="parameters.html#var-in-out">VAR_IN_OUT</a></li>
<li class="toctree-l3"><a class="reference internal" href="parameters.html#var-in-out-constant">VAR_IN_OUT CONSTANT</a></li>
<li class="toctree-l3"><a class="reference internal" href="parameters.html#consistency">Consistency</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="visibility.html">Visibility Control</a><ul>
<li class="toctree-l3"><a class="reference internal" href="visibility.html#attributes-for-controlling-the-visibility">Attributes for Controlling the Visibility</a></li>
<li class="toctree-l3"><a class="reference internal" href="visibility.html#keywords-for-controlling-the-visibility">Keywords for Controlling the Visibility</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="external.html">External Libraries</a><ul>
<li class="toctree-l3"><a class="reference internal" href="optional.html">Working with external optional Libraries</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="friends.html">Developers best friends</a><ul>
<li class="toctree-l3"><a class="reference internal" href="friends.html#specify-the-intended-use">Specify the intended use</a></li>
<li class="toctree-l3"><a class="reference internal" href="friends.html#identify">Identify your System</a></li>
<li class="toctree-l3"><a class="reference internal" href="friends.html#respond-to-specific-situations">Respond to specific Situations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="friends.html#example-and-demonstration">Example and Demonstration</a></li>
<li class="toctree-l4"><a class="reference internal" href="friends.html#helper-structures-for-generic-types">Helper Structures for Generic Types</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 current"><a class="reference internal" href="advanced.html">Advanced Topicâs</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="date_time.html">Duration, Date and Time</a><ul>
<li class="toctree-l4"><a class="reference internal" href="date_time.html#duration">Duration</a></li>
<li class="toctree-l4"><a class="reference internal" href="date_time.html#date-and-time">Date and Time</a></li>
<li class="toctree-l4"><a class="reference internal" href="date_time.html#special-applications">Special Applications</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="mem_block_man.html">Application of the Memory Block Manager</a><ul>
<li class="toctree-l4"><a class="reference internal" href="mem_block_man.html#pool-based-memory-management">Pool based memory management</a></li>
<li class="toctree-l4"><a class="reference internal" href="mem_block_man.html#application-and-management-of-messages">Application and management of messages</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="fb_factory.html">Dynamic Generation of FB Instances</a></li>
<li class="toctree-l3"><a class="reference internal" href="segmented_buffers.html">Segmented Buffers</a><ul>
<li class="toctree-l4"><a class="reference internal" href="segmented_buffers.html#beispiele">Beispiele</a></li>
</ul>
</li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Synchronization of Concurrent Execution</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#sema">SEMA</a></li>
<li class="toctree-l4"><a class="reference internal" href="#bolt">BOLT</a></li>
<li class="toctree-l4"><a class="reference internal" href="#task-lock">Task Lock</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="async.html">Asynchronous Job Execution</a><ul>
<li class="toctree-l4"><a class="reference internal" href="async.html#applications-in-codesys">Applications in CODESYS</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="multicore.html">Multicore - Tools</a><ul>
<li class="toctree-l4"><a class="reference internal" href="multicore.html#introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="multicore.html#example">Example</a></li>
<li class="toctree-l4"><a class="reference internal" href="multicore.html#measurement">Measurement</a></li>
<li class="toctree-l4"><a class="reference internal" href="multicore.html#atomic-operations">Atomic Operations</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="file_server.html">Providing libraries and device descriptions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="file_server.html#libraries">Libraries</a></li>
<li class="toctree-l4"><a class="reference internal" href="file_server.html#device-descriptions">Device Descriptions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="certificate.html">Usage of client certificates from an external certification authority</a><ul>
<li class="toctree-l4"><a class="reference internal" href="certificate.html#import-of-client-certificates-via-csr">Import of client certificates via CSR</a></li>
<li class="toctree-l4"><a class="reference internal" href="certificate.html#import-of-client-certificates-with-private-key">Import of client certificates with private key</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="guidelines.html">Guidelines for Library Development</a><ul>
<li class="toctree-l2"><a class="reference internal" href="filename.html">Select a meaningful filename</a></li>
<li class="toctree-l2"><a class="reference internal" href="namespaces.html">Select a pragmatic library namespace</a></li>
<li class="toctree-l2"><a class="reference internal" href="projectinfo.html">Enter all project information</a></li>
<li class="toctree-l2"><a class="reference internal" href="reuse.html">Apply the correct method for referencing other libraries</a></li>
<li class="toctree-l2"><a class="reference internal" href="interfaces.html">Design smart interfaces</a></li>
<li class="toctree-l2"><a class="reference internal" href="errors.html">Implement user-friendly error handling</a></li>
<li class="toctree-l2"><a class="reference internal" href="deployment.html">Use the correct method for deployment and licensing</a><ul>
<li class="toctree-l3"><a class="reference internal" href="deployment.html#platform-vendor-dependent-usage-restriction">Platform-/vendor dependent usage restriction</a></li>
<li class="toctree-l3"><a class="reference internal" href="deployment.html#licensing-for-codesys-store">Licensing for CODESYS Store</a><ul>
<li class="toctree-l4"><a class="reference internal" href="deployment.html#engineering-license-via-codesys-security-key">Engineering-License via CODESYS Security Key</a></li>
<li class="toctree-l4"><a class="reference internal" href="deployment.html#engineering-license-via-soft-container">Engineering-License via Soft Container</a></li>
<li class="toctree-l4"><a class="reference internal" href="deployment.html#single-controller-license-via-cmpcodemeter">Single-Controller-License via CmpCodemeter</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="deployment.html#licensing-via-3slicense-library">Licensing via 3SLicense.library</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="templates.html">Ensure consistency by using templates</a><ul>
<li class="toctree-l3"><a class="reference internal" href="templates.html#template-types">Template Types</a></li>
<li class="toctree-l3"><a class="reference internal" href="templates.html#function-blocks-design-patterns">Function Blocks Design Patterns</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="structure.html">Use a familiar and uniform project structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="varnames.html">Ensure clean code by applying a consistent naming conventions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="varnames.html#standard-data-types">Standard Data Types</a></li>
<li class="toctree-l3"><a class="reference internal" href="varnames.html#scope-marker">Scope Marker</a></li>
<li class="toctree-l3"><a class="reference internal" href="varnames.html#safety-data-types">Safety Data Types</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="documentation.html">Library Documentation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="docAreas.html">Documentation Areas</a><ul>
<li class="toctree-l3"><a class="reference internal" href="docAreas.html#project-information">Project Information</a></li>
<li class="toctree-l3"><a class="reference internal" href="docAreas.html#folder">Folder</a></li>
<li class="toctree-l3"><a class="reference internal" href="docAreas.html#declaration-header">Declaration Header</a></li>
<li class="toctree-l3"><a class="reference internal" href="docAreas.html#member-declaration">Member Declaration</a></li>
<li class="toctree-l3"><a class="reference internal" href="docAreas.html#enums-structures-gvl-s">Enums, Structures, GVLâs</a></li>
<li class="toctree-l3"><a class="reference internal" href="docAreas.html#actions-and-transitions">Actions and Transitions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="reSTOverview.html">Formatting Commands (Overview)</a></li>
<li class="toctree-l2"><a class="reference internal" href="reSTOverview.html#the-markup-specification">The Markup Specification</a></li>
<li class="toctree-l2"><a class="reference internal" href="reSTOverview.html#codesys-specific-formatting-commands">CODESYS Specific Formatting Commands</a></li>
<li class="toctree-l2"><a class="reference internal" href="install-win.html">Tool installation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="install-win.html#installing-python-on-windows">Installing Python on Windows</a><ul>
<li class="toctree-l4"><a class="reference internal" href="install-win.html#setuptools">Setuptools</a></li>
<li class="toctree-l4"><a class="reference internal" href="install-win.html#pip">Pip</a></li>
<li class="toctree-l4"><a class="reference internal" href="install-win.html#virtualenv">Virtualenv</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="install-win.html#virtualenv-wrapper-optional">Virtualenv Wrapper (optional)</a></li>
<li class="toctree-l3"><a class="reference internal" href="install-win.html#notepad">Notepad++</a></li>
<li class="toctree-l3"><a class="reference internal" href="install-win.html#html-help-workshop">HTML Help Workshop</a></li>
<li class="toctree-l3"><a class="reference internal" href="install-win.html#tex-live-for-windows">TeX Live for Windows</a></li>
<li class="toctree-l3"><a class="reference internal" href="install-win.html#po-file-editor">PO File Editor</a></li>
<li class="toctree-l3"><a class="reference internal" href="install-win.html#microsoft-visual-c-compiler-for-python-2-7">Microsoft Visual C++ Compiler for Python 2.7</a></li>
<li class="toctree-l3"><a class="reference internal" href="install-win.html#mingw-compiler">MinGW Compiler</a></li>
<li class="toctree-l3"><a class="reference internal" href="install-win.html#libdoc-scripting-collection">LibDoc Scripting Collection</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="docScripting.html">Script your Documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="styles.html">Page Layout Setup</a><ul>
<li class="toctree-l3"><a class="reference internal" href="styles.html#templates">Templates</a></li>
<li class="toctree-l3"><a class="reference internal" href="styles.html#themes">Themes</a><ul>
<li class="toctree-l4"><a class="reference internal" href="styles.html#themes-for-html-based-output">Themes for HTML-Based Output</a></li>
<li class="toctree-l4"><a class="reference internal" href="styles.html#themes-for-pdf-output">Themes for PDF Output</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="outputs.html">Different Output Formats for Library Documentation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="outputs.html#html-output-format">HTML Output Format</a></li>
<li class="toctree-l3"><a class="reference internal" href="outputs.html#lmd-output-format">LMD Output Format</a></li>
<li class="toctree-l3"><a class="reference internal" href="outputs.html#chm-output-format">CHM Output Format</a></li>
<li class="toctree-l3"><a class="reference internal" href="outputs.html#pdf-output-format">PDF Output Format</a></li>
<li class="toctree-l3"><a class="reference internal" href="outputs.html#pot-output-format">POT Output Format</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="localization.html">Documentation in Different Languages</a><ul>
<li class="toctree-l3"><a class="reference internal" href="localization.html#generating-translations">Generating Translations</a></li>
<li class="toctree-l3"><a class="reference internal" href="localization.html#deployment-of-translated-documents">Deployment of Translated Documents</a></li>
<li class="toctree-l3"><a class="reference internal" href="localization.html#workflow-for-localising-signed-libraries">Workflow for Localising Signed Libraries</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="documentation.html#examples-of-restructuredtext">Examples of âreStructuredTextâ</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="packages.html">Package Designer</a></li>
<li class="toctree-l1"><a class="reference internal" href="checklist.html">Library Development Checklist</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="glossary.html">Glossary</a></li>
</ul>

            
          
                </div>
            </div>
        </nav>

        <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
            
            <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
                <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
                <a href="index.html">CODESYS LibDevSummary</a>
            </nav>


            
            <div class="wy-nav-content">
                <div class="rst-content">
                    

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
          <li><a href="concepts.html">Concepts and Elements</a> &raquo;</li>
      
          <li><a href="advanced.html">Advanced Topicâs</a> &raquo;</li>
      
    <li>Synchronization of Concurrent Execution</li>
  </ul>
  <hr/>
</div>
                    <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
                        <div itemprop="articleBody">
                            
  <section id="synchronization-of-concurrent-execution">
<span id="synchronization"></span><h1>Synchronization of Concurrent Execution<a class="headerlink" href="#synchronization-of-concurrent-execution" title="Permalink to this heading">Â¶</a></h1>
<p>The less concurrent parallel running processes have to be synchronized, the better.
Each synchronization means an increase in complexity and thus the probability of writing incorrect code is significantly increased.
Each synchronization requires the processing of additional code segments, which often significantly reduces the processing speed of an application.
Conversely, the distribution of specific functions to different tasks can significantly increase the responsiveness of an application,
because the correct choice of the priority and appropriate selection of common data can significantly reduce the cycle time of certain tasks.
However, the effort required to synchronize the various tasks must never be forgotten.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The exchange of data between different tasks can be carried out with the functions (Message Passing via Queue handling) of the
<code class="docutils literal notranslate"><span class="pre">CAA_MemBlockManager</span></code>  (<code class="docutils literal notranslate"><span class="pre">MBM.XChgCreateH</span></code>, <code class="docutils literal notranslate"><span class="pre">MBM.XChgCreateP</span></code>, <code class="docutils literal notranslate"><span class="pre">MBM.MsgSend</span></code> , <code class="docutils literal notranslate"><span class="pre">MBM.MsgReceive</span></code>, â¦).
Alternatively the jobs of different tasks on shared memory can be coordinated with the following functions or function blocks.
These function blocks are also meant for end users and execute the task synchronization in a non-blocking way.</p>
</div>
<p>Tasks are always processed logically independent of each other. However, it may also be the case that several tasks have to
process sub-tasks of a more complex overall problem and use certain resources, in particular data, together.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">Sema</span></code> and the <code class="docutils literal notranslate"><span class="pre">Bolt</span></code> function blocks, are available to control such coordination work. If access to shared
resources (e. g. data, procedures, devices) is to be coordinated, an instance of one of these synchronization blocks
is assigned to each of these resources; the user tasks then execute a ârequestâ statement before using an resource and,
after use, a âreleaseâ statement of the assigned synchronization instance.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The function block types <code class="docutils literal notranslate"><span class="pre">Sema</span></code> and <code class="docutils literal notranslate"><span class="pre">Bolt</span></code> are part of the library <cite>CAA Types Extern</cite>.
Please execute âAdd Libraryâ and search e. g. for the string <cite>BOLT</cite>.</p>
<blockquote>
<div><img alt="_images/bolt.png" src="_images/bolt.png" />
</div></blockquote>
</div>
<p>A binary semaphore is usually common used for realizing mutual exclusion for a critical section.
By contrast, a variable of the data type âBOLTâ (see DIN 66253, Part 1) can be used to control
the exclusive or simultaneous access to a critical section.</p>
<section id="sema">
<h2>SEMA<a class="headerlink" href="#sema" title="Permalink to this heading">Â¶</a></h2>
<div class="highlight-codesys notranslate"><div class="highlight"><pre><span></span><span class="k">FUNCTION_BLOCK</span> <span class="n">SEMA</span> <span class="cm">(* Prefix: sem *)</span>
<span class="k">METHOD</span> <span class="n">Request</span> <span class="p">:</span> <span class="kt">BOOL</span>
<span class="k">METHOD</span> <span class="n">Release</span> <span class="p">:</span> <span class="kt">BOOL</span>
</pre></div>
</div>
<p>This function block realizes a counting semaphore.
It is based on the runtime system function <code class="docutils literal notranslate"><span class="pre">SysCpuTestAndSet</span></code>.
A function block of type <code class="docutils literal notranslate"><span class="pre">SEMA</span></code> is used to manage limited resources in a multi tasking environment.
The counter of the semaphore symbolizes the number of resources available.
If there is no special parametrization, the semaphore counter has the value one.
The resources assigned to the semaphore are accessed with the <code class="docutils literal notranslate"><span class="pre">Request</span></code> method.
This works as long as the counter is not zero at the time of the <code class="docutils literal notranslate"><span class="pre">Request</span></code> call. The counter is then reduced by one.
With the method <code class="docutils literal notranslate"><span class="pre">Release</span></code> the resource previously accessed is released and the counter is increased by one.
The call of the method <code class="docutils literal notranslate"><span class="pre">Preset</span></code> adjusts the initial counter of the semaphore in accordance with the requirements.
If the method was executed successfully <code class="docutils literal notranslate"><span class="pre">TRUE</span></code> is returned, else <code class="docutils literal notranslate"><span class="pre">FALSE</span></code> is returned.
A resource may thus only be used if the call <code class="docutils literal notranslate"><span class="pre">Request</span></code> returns <code class="docutils literal notranslate"><span class="pre">TRUE</span></code>.</p>
<div class="admonition attention">
<p class="admonition-title">Attention</p>
<p>A resource is not released successfully until the call <code class="docutils literal notranslate"><span class="pre">Release</span></code> returns <code class="docutils literal notranslate"><span class="pre">TRUE</span></code>.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Like shown in the example below, it is also allowed to first âReleaseâ a resource (increasing its counter by one)
before having ever âRequestâed it.</p>
</div>
<div class="admonition-example admonition">
<p class="admonition-title">Example</p>
<p>Single Writer (Producer) â Single Reader (Consumer)</p>
<div class="line-block">
<div class="line">The âConsumerâ and âProducerâ are names of two different tasks. They share a global resource called âg_abyBufferâ.</div>
<div class="line">The âConsumerâ task will process the data out of the buffer.</div>
<div class="line">The âProducerâ tasks will fill the buffer with some important data.</div>
</div>
<div class="line-block">
<div class="line">The âProducerâ can not overwrite not yet readed data.</div>
<div class="line">The âConsumerâ can only read already produced data.</div>
</div>
<div class="highlight-codesys notranslate"><div class="highlight"><pre><span></span><span class="k">VAR_GLOBAL</span>
    <span class="c1">// Synchronize Producers</span>
    <span class="n">g_semWriteLock</span> <span class="p">:</span> <span class="n">CAA.SEMA</span><span class="p">;</span>
    <span class="n">g_xWriterActive</span> <span class="p">:</span> <span class="kt">BOOL</span><span class="p">;</span>

    <span class="c1">// Synchronize the Consumer</span>
    <span class="n">g_semReadLock</span> <span class="p">:</span> <span class="n">CAA.SEMA</span>  <span class="p">:=</span> <span class="p">(</span><span class="n">ctPreset</span><span class="p">:=</span><span class="mi">0</span><span class="p">);</span> <span class="cm">(* !! *)</span>
    <span class="n">g_xReaderActive</span> <span class="p">:</span> <span class="kt">BOOL</span><span class="p">;</span>

    <span class="c1">// The buffer, a memory area as a global resource</span>
    <span class="n">g_abyBuffer</span> <span class="p">:</span> <span class="k">ARRAY</span><span class="l">[0..4095]</span> <span class="k">OF</span> <span class="kt">BYTE</span><span class="p">;</span>
<span class="k">END_VAR</span>
</pre></div>
</div>
<div class="highlight-codesys notranslate"><div class="highlight"><pre><span></span><span class="k">METHOD</span> <span class="n">Consume</span><span class="p">:</span> <span class="kt">BOOL</span>
<span class="k">VAR</span>
    <span class="n">byData</span> <span class="p">:</span> <span class="kt">BYTE</span><span class="p">;</span>
<span class="k">END_VAR</span>
</pre></div>
</div>
<div class="highlight-codesys notranslate"><div class="highlight"><pre><span></span><span class="k">IF</span> <span class="n">g_xReaderActive</span> <span class="k">THEN</span>
    <span class="n">Consume</span> <span class="p">:=</span> <span class="n">g_semWriteLock.Release</span><span class="p">();</span>
    <span class="n">g_xReaderActive</span> <span class="p">:=</span> <span class="k">NOT</span> <span class="n">Consume</span><span class="p">;</span>
    <span class="k">RETURN</span><span class="p">;</span>
<span class="k">END_IF</span>

<span class="k">IF</span> <span class="k">NOT</span> <span class="n">g_xReaderActive</span> <span class="n">AND_THEN</span> <span class="n">g_semReadLock.Request</span><span class="p">()</span> <span class="k">THEN</span>
    <span class="cm">(* do some stuff with the data *)</span>
    <span class="n">byData</span> <span class="p">:=</span> <span class="n">g_abyBuffer</span><span class="l">[0]</span><span class="p">;</span>
    <span class="n">Consume</span> <span class="p">:=</span> <span class="n">g_semWriteLock.Release</span><span class="p">();</span>
    <span class="n">g_xReaderActive</span> <span class="p">:=</span> <span class="k">NOT</span> <span class="n">Consume</span><span class="p">;</span>
<span class="k">ELSE</span>
    <span class="n">Consume</span> <span class="p">:=</span> <span class="kc">FALSE</span><span class="p">;</span>
<span class="k">END_IF</span>
</pre></div>
</div>
<div class="highlight-codesys notranslate"><div class="highlight"><pre><span></span><span class="k">METHOD</span> <span class="n">Produce</span> <span class="p">:</span> <span class="kt">BOOL</span><span class="p">;</span>
<span class="k">VAR_IN_OUT</span>
    <span class="n">abyData</span> <span class="p">:</span> <span class="k">ARRAY</span><span class="l">[*]</span> <span class="k">OF</span> <span class="kt">BYTE</span><span class="p">;</span>
<span class="k">END_VAR</span>
</pre></div>
</div>
<div class="highlight-codesys notranslate"><div class="highlight"><pre><span></span><span class="k">IF</span> <span class="n">g_xWriterActive</span> <span class="k">THEN</span>
    <span class="n">Produce</span> <span class="p">:=</span> <span class="n">g_semReadLock.Release</span><span class="p">();</span>
    <span class="n">g_xWriterActive</span> <span class="p">:=</span> <span class="k">NOT</span> <span class="n">Produce</span><span class="p">;</span>
    <span class="k">RETURN</span><span class="p">;</span>
<span class="k">END_IF</span>

<span class="k">IF</span> <span class="k">NOT</span> <span class="n">g_xWriterActive</span> <span class="n">AND_THEN</span> <span class="n">g_semWriteLock.Request</span><span class="p">()</span> <span class="k">THEN</span>
    <span class="cm">(* take the data and prepare the buffer ``g_abyBuffer`` *)</span>
    <span class="n">Produce</span> <span class="p">:=</span> <span class="n">g_semReadLock.Release</span><span class="p">();</span>
    <span class="n">g_xWriterActive</span> <span class="p">:=</span> <span class="k">NOT</span> <span class="n">Produce</span><span class="p">;</span>
<span class="k">ELSE</span>
    <span class="n">Produce</span> <span class="p">:=</span> <span class="kc">FALSE</span><span class="p">;</span>
<span class="k">END_IF</span>
</pre></div>
</div>
</div>
<p>The âconsumerâ waits for the release of <code class="docutils literal notranslate"><span class="pre">g_semReadLock</span></code>, i. e. for processing a message,
because <code class="docutils literal notranslate"><span class="pre">g_semReadLock</span></code> can only be released by a âproducerâ.
After the processing has been completed, a âconsumerâ releases <code class="docutils literal notranslate"><span class="pre">g_semWriteLock</span></code>, allowing further processing and
waiting for a new request. A âproducerâ can only buffer a message
if the state âfreeâ is defined for <code class="docutils literal notranslate"><span class="pre">g_semWriteLock</span></code>; after buffering a message,
they release <code class="docutils literal notranslate"><span class="pre">g_semReadLock</span></code> and thus trigger the âconsumerâ.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <code class="docutils literal notranslate"><span class="pre">SEMA</span></code> function block and its methods are implemented in a non blocking way.
So the task-cycle is not blocked and the PLC can do some other work while âwaitingâ for a <cite>semaphore</cite>.</p>
</div>
</section>
<section id="bolt">
<h2>BOLT<a class="headerlink" href="#bolt" title="Permalink to this heading">Â¶</a></h2>
<p>Assume that in different tasks, the same data is used for calculation but not modified (for example, border values
for monitoring processes); in addition, another task is to recalculate this data (for example, specification of new monitoring data).
It should be ensured that the processes for modifying and using the data are mutually exclusive; however, simultaneous
use of the data (through several tasks) is wanted.</p>
<p>In principle, these problems can be solved with the ârequestâ and âreleaseâ statements described above; however,
the formulation is relatively complicated and the run time for execution is considerable. For this reason,
four additional methods are offered that work with instances of the function block âBOLTâ.</p>
<p>A bolt variable can assume the states âlockedâ, âlock possibleâ or âlock not possibleâ,
depending on whether the assigned resource is exclusively used, free or simultaneously used.</p>
<p>The instance of a <code class="docutils literal notranslate"><span class="pre">BOLT</span></code> function block is assigned to a resource.
When entering a critical section for exclusive use of this resource,
the access to this critical section of other tasks is prevented by executing the <code class="docutils literal notranslate"><span class="pre">Reserve</span></code> method.
The release when leaving this critical section is done by using the method <code class="docutils literal notranslate"><span class="pre">Free</span></code>.
The critical sections for simultaneous use of a resource is initiated or finished by executing the
methods <code class="docutils literal notranslate"><span class="pre">Enter</span></code> or <code class="docutils literal notranslate"><span class="pre">Leave</span></code>.</p>
<div class="highlight-codesys notranslate"><div class="highlight"><pre><span></span><span class="k">FUNCTION_BLOCK</span> <span class="n">BOLT</span> <span class="cm">(* Prefix: blt *)</span>
</pre></div>
</div>
<p>Methods of function block <code class="docutils literal notranslate"><span class="pre">BOLT</span></code> for handling simultaneous access:</p>
<div class="highlight-codesys notranslate"><div class="highlight"><pre><span></span><span class="k">METHOD</span> <span class="n">Enter</span> <span class="p">:</span> <span class="kt">BOOL</span>
<span class="k">METHOD</span> <span class="n">Leave</span> <span class="p">:</span> <span class="kt">BOOL</span>
</pre></div>
</div>
<p>Methods of function block <code class="docutils literal notranslate"><span class="pre">BOLT</span></code> for handling exclusive access:</p>
<div class="highlight-codesys notranslate"><div class="highlight"><pre><span></span><span class="k">METHOD</span> <span class="n">Reserve</span> <span class="p">:</span> <span class="kt">BOOL</span>
<span class="k">VAR_IN_OUT</span>
    <span class="n">ctValue</span> <span class="p">:</span> <span class="n">COUNT</span><span class="p">;</span>
<span class="k">END_VAR</span>

<span class="k">METHOD</span> <span class="n">Free</span> <span class="p">:</span> <span class="kt">BOOL</span>
</pre></div>
</div>
<p>This function block gives exclusive or simultaneous access to a critical section.
It is based on the runtime system function <code class="docutils literal notranslate"><span class="pre">SysCpuTestAndSet</span></code>.
Exclusive access is only possible after all simultaneous accesses have been ended.
As long as there is an exclusive access, the simultaneous access calls are rejected.
Simultaneous accesses are initiated with the method <code class="docutils literal notranslate"><span class="pre">Enter</span></code>. This means the number of accesses in the critical section is increased by one.
The method <code class="docutils literal notranslate"><span class="pre">Leave</span></code> is required to leave the critical section. It reduces the number of accesses in the critical section by one.
Exclusive access is requested with the method <code class="docutils literal notranslate"><span class="pre">Reserve</span></code> .
This call can only be successful if the number of accesses in the critical section equals zero.
If this is not the case, all new calls of the method <code class="docutils literal notranslate"><span class="pre">Enter</span></code> are denied to make sure the number of accesses is not increased further.
If all those who previously accessed the critical section have left with the method <code class="docutils literal notranslate"><span class="pre">Leave</span></code>, the next call of the method <code class="docutils literal notranslate"><span class="pre">Reserve</span></code> will be successful.
The critical section can now be accessed exclusively. When all work is done, the section has to be freed with the method <code class="docutils literal notranslate"><span class="pre">Free</span></code>.
If exclusive access has already been granted, calls for simultaneous access are denied.
Further calls for exclusive access are also denied but they are counted.
The calls for simultaneous access are successful as soon as all exclusive accesses have been ended.
If the method was executed successfully, <code class="docutils literal notranslate"><span class="pre">TRUE</span></code> is returned, else <code class="docutils literal notranslate"><span class="pre">FALSE</span></code> is returned.
A critical section may only be accessed if the methods <code class="docutils literal notranslate"><span class="pre">Enter</span></code> or <code class="docutils literal notranslate"><span class="pre">Reserve</span></code> have returned <code class="docutils literal notranslate"><span class="pre">TRUE</span></code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <code class="docutils literal notranslate"><span class="pre">Reserve</span></code> method has an extra state variable (<code class="docutils literal notranslate"><span class="pre">ctValue</span></code>) for distinguishing a ânewâ (<code class="docutils literal notranslate"><span class="pre">ctValue</span> <span class="pre">=</span> <span class="pre">0</span></code>) reservation
from an previous one (ctValue &lt;&gt; 0) which is still asking for access.
In this respect, <code class="docutils literal notranslate"><span class="pre">ctValue</span></code> can be considered a reservation ticket number.
A value of zero means that no reservation has been made so far.
A value not equal to zero means that a reservation has been made.
The variable <code class="docutils literal notranslate"><span class="pre">ctValue</span></code> should be located in a memory area which is specific for the context (e.g. task) in
which the call of the <code class="docutils literal notranslate"><span class="pre">Reserve</span></code> method occurs.</p>
<p>If the call of âReserveâ returns with the value <code class="docutils literal notranslate"><span class="pre">FALSE</span></code> it is absolute necessary to continue the reservation
tries until the return value is <code class="docutils literal notranslate"><span class="pre">TRUE</span></code>. Without this measure every call of âEnterâ will return with <code class="docutils literal notranslate"><span class="pre">FALSE</span></code>
and so the simultaneous mode of the critical section is locked for ever.</p>
</div>
<div class="admonition attention">
<p class="admonition-title">Attention</p>
<p>A resource is not released successfully until the call <code class="docutils literal notranslate"><span class="pre">Free</span></code> or <code class="docutils literal notranslate"><span class="pre">Leave</span></code> returns <code class="docutils literal notranslate"><span class="pre">TRUE</span></code>.</p>
</div>
<div class="admonition-example admonition">
<p class="admonition-title">Example</p>
<p>A task âMeasurementâ continuously determines the border values of variables from a process to be monitored,
which are required by the tasks âControlâ and âSchedulingâ for calculations.
It should be ensured that âMeasurementâ changes the the border values only if they are not used;
on the other hand, the tasks âControlâ and âSchedulingâ should use the the border values simultaneously.</p>
<p>For this purpose, a instance variable of type <code class="docutils literal notranslate"><span class="pre">BOLT</span></code> called âg_bltBordersâ is declared; in the bodies of the three tasks,
the critical sections of the modification or use of the border values (<code class="docutils literal notranslate"><span class="pre">g_BorderValues</span></code>) are initiated or finished as follows:</p>
<div class="highlight-codesys notranslate"><div class="highlight"><pre><span></span><span class="k">VAR_GLOBAL</span>
    <span class="n">g_BorderValues</span> <span class="p">:</span> <span class="n">BORDERS</span><span class="p">;</span>
    <span class="n">g_bltBorders</span> <span class="p">:</span> <span class="n">CAA.BOLT</span><span class="p">;</span>
    <span class="n">g_xMeasurementActive</span> <span class="p">:</span> <span class="kt">BOOL</span><span class="p">;</span>
<span class="k">END_VAR</span>
</pre></div>
</div>
<div class="highlight-codesys notranslate"><div class="highlight"><pre><span></span><span class="c1">// Called by task &quot;Measurement&quot;</span>
<span class="k">METHOD</span> <span class="n">Measure</span> <span class="p">:</span> <span class="kt">BOOL</span>
<span class="k">VAR_IN_OUT</span>
    <span class="n">udiTicket</span> <span class="p">:</span> <span class="kt">UDINT</span> <span class="p">:=</span> <span class="mi">0</span><span class="p">;</span> <span class="c1">// Reservation Ticket</span>
<span class="k">END_VAR</span>
</pre></div>
</div>
<div class="highlight-codesys notranslate"><div class="highlight"><pre><span></span><span class="k">IF</span> <span class="n">g_xMeasurementActive</span> <span class="k">THEN</span>
    <span class="n">Measure</span> <span class="p">:=</span> <span class="n">g_bltBorders.Free</span><span class="p">();</span>
    <span class="n">g_xMeasurementActive</span> <span class="p">:=</span> <span class="k">NOT</span> <span class="n">Measure</span><span class="p">;</span>
    <span class="k">RETURN</span><span class="p">;</span>
<span class="k">END_IF</span>

<span class="k">IF</span> <span class="k">NOT</span> <span class="n">g_xMeasurementActive</span> <span class="n">AND_THEN</span> <span class="n">g_bltBorders.Reserve</span><span class="p">(</span><span class="n">udiTicket</span><span class="p">)</span> <span class="k">THEN</span>
    <span class="cm">(* determine new border values *)</span>
    <span class="n">Measure</span> <span class="p">:=</span> <span class="n">g_bltBorders.Free</span><span class="p">();</span>
    <span class="n">g_xMeasurementActive</span> <span class="p">:=</span> <span class="k">NOT</span> <span class="n">Measure</span><span class="p">;</span>
<span class="k">ELSE</span>
    <span class="n">Measure</span> <span class="p">:=</span> <span class="kc">FALSE</span><span class="p">;</span>
<span class="k">END_IF</span>
</pre></div>
</div>
<div class="highlight-codesys notranslate"><div class="highlight"><pre><span></span><span class="c1">// Called by tasks &quot;Control&quot; and &quot;Scheduling&quot;</span>
<span class="k">METHOD</span> <span class="n">Calculate</span> <span class="p">:</span> <span class="kt">BOOL</span>
<span class="k">VAR</span>
    <span class="n">pxCalculatorActive</span> <span class="p">:</span> <span class="k">POINTER</span> <span class="k">TO</span> <span class="kt">BOOL</span><span class="p">;</span>
<span class="k">END_VAR</span>
</pre></div>
</div>
<div class="highlight-codesys notranslate"><div class="highlight"><pre><span></span><span class="n">pxCalculatorActive</span> <span class="p">:=</span> <span class="n">GetTaskLocalStorage</span><span class="p">();</span>

<span class="k">IF</span> <span class="n">pxCalculatorActive</span><span class="p">^</span> <span class="k">THEN</span>
    <span class="n">Calculate</span> <span class="p">:=</span> <span class="n">g_bltBorders.Leave</span><span class="p">();</span>
    <span class="n">pxCalculatorActive</span><span class="p">^</span> <span class="p">:=</span> <span class="k">NOT</span> <span class="n">Calculate</span><span class="p">;</span>
    <span class="k">RETURN</span><span class="p">;</span>
<span class="k">END_IF</span>

<span class="k">IF</span> <span class="k">NOT</span> <span class="n">pxCalculatorActive</span><span class="p">^</span> <span class="n">AND_THEN</span> <span class="n">g_bltBorders.Enter</span><span class="p">()</span> <span class="k">THEN</span>
    <span class="cm">(* read and utilize the border values *)</span>
    <span class="n">Calculate</span> <span class="p">:=</span> <span class="n">g_bltBorders.Leave</span><span class="p">();</span>
    <span class="n">pxCalculatorActive</span><span class="p">^</span> <span class="p">:=</span> <span class="k">NOT</span> <span class="n">Calculate</span><span class="p">;</span>
<span class="k">ELSE</span>
    <span class="n">Calculate</span> <span class="p">:=</span> <span class="kc">FALSE</span><span class="p">;</span>
<span class="k">END_IF</span>
</pre></div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <code class="docutils literal notranslate"><span class="pre">BOLT</span></code> function block and its methods are implemented in a non blocking way.
So the task-cycle is not blocked and the PLC can do some other work while âwaitingâ for a <cite>bolt</cite>.</p>
<p>If more then one Task is sharing the <code class="docutils literal notranslate"><span class="pre">Calculate</span></code> method a task specific location for <code class="docutils literal notranslate"><span class="pre">xCalculatorActive</span></code> is necessary.
This location is provided in the example above from the hypothetical function <code class="docutils literal notranslate"><span class="pre">GetTaskLocalStorage</span></code>.
It determines the current task context and provide the address of the task local variables.</p>
</div>
</section>
<section id="task-lock">
<h2>Task Lock<a class="headerlink" href="#task-lock" title="Permalink to this heading">Â¶</a></h2>
<p>Sometimes it is important that the current IEC task cannot be interrupted by other IEC tasks. The rest of the task system,
however, must work on, unaffected by this requirement. In these cases, the <code class="docutils literal notranslate"><span class="pre">TaskLock</span></code> and <code class="docutils literal notranslate"><span class="pre">TaskUnlock</span></code> functions offer
the possibility  to build a save zone, in which common IEC resources can be consistently modified over a few lines of
IEC code, unaffected by other IEC-Tasks.</p>
<div class="highlight-codesys notranslate"><div class="highlight"><pre><span></span><span class="k">FUNCTION</span> <span class="n">TaskLock</span> <span class="p">:</span> <span class="n">ERROR</span>
<span class="k">VAR_INPUT</span>
    <span class="n">xDummy</span> <span class="p">:</span> <span class="kt">BOOL</span><span class="p">;</span>
<span class="k">END_VAR</span>
</pre></div>
</div>
<div class="highlight-codesys notranslate"><div class="highlight"><pre><span></span><span class="k">FUNCTION</span> <span class="n">TaskUnlock</span> <span class="p">:</span> <span class="n">ERROR</span>
<span class="k">VAR_INPUT</span>
    <span class="n">xDummy</span> <span class="p">:</span> <span class="kt">BOOL</span><span class="p">;</span>
<span class="k">END_VAR</span>
</pre></div>
</div>
<p>These two functions using a global semaphore to synchronize IEC tasks.
In this way the other tasks are suspended when they call <code class="docutils literal notranslate"><span class="pre">TaskLock</span></code> if the first IEC task has already called <code class="docutils literal notranslate"><span class="pre">TaskLock</span></code>.
The suspension persists until the first task has called <code class="docutils literal notranslate"><span class="pre">TaskUnlock</span></code>.
Therefore it is very important to limit the time spent between <code class="docutils literal notranslate"><span class="pre">TaskLock</span></code> and <code class="docutils literal notranslate"><span class="pre">TaskUnlock</span></code> to an absolute minimum.
Otherwise, the reactivity of the entire application is compromised.</p>
<div class="admonition-example admonition">
<p class="admonition-title">Example</p>
<p>The method <code class="docutils literal notranslate"><span class="pre">PopElement</span></code> in the following piece of code demonstrates a possible use case of <code class="docutils literal notranslate"><span class="pre">TaskLock</span></code> and <code class="docutils literal notranslate"><span class="pre">TaskUnock</span></code> in
which a double-linked list is modified in such a way that the first element of the list is no longer connected to
the rest of the list and can then be returned to the caller. The IEC code of this operation must not be interrupted
by another IEC task because otherwise the list could be get in a inconsistent state.</p>
<div class="highlight-codesys notranslate"><div class="highlight"><pre><span></span><span class="k">METHOD</span> <span class="n">PopElem</span> <span class="p">:</span> <span class="n">IElement</span>
</pre></div>
</div>
<div class="highlight-codesys notranslate"><div class="highlight"><pre><span></span><span class="cp">{IF defined (pou:CAA.TaskLock)}</span>
    <span class="n">CAA.TaskLock</span><span class="p">(</span><span class="kc">FALSE</span><span class="p">);</span>
<span class="cp">{END_IF}</span>

<span class="k">IF</span> <span class="n">itfHead</span> <span class="p">&lt;&gt;</span> <span class="mi">0</span> <span class="k">THEN</span>
    <span class="n">PopElem</span> <span class="p">:=</span> <span class="n">itfHead</span><span class="p">;</span>
    <span class="n">itfHead</span> <span class="p">:=</span> <span class="n">PopElem.NextElem</span><span class="p">;</span>

    <span class="n">PopElem.NextElem</span> <span class="p">:=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="n">PopElem.PrevElem</span> <span class="p">:=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="n">PopElem.List</span> <span class="p">:=</span> <span class="mi">0</span><span class="p">;</span>

    <span class="n">ctSize</span> <span class="p">:=</span> <span class="n">ctSize</span> <span class="p">-</span> <span class="mi">1</span><span class="p">;</span>

    <span class="k">IF</span> <span class="n">itfHead</span> <span class="p">=</span> <span class="mi">0</span> <span class="k">THEN</span>
        <span class="n">itfTail</span> <span class="p">:=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">ELSE</span>
        <span class="n">itfHead.PrevElem</span> <span class="p">:=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">END_IF</span>
<span class="k">END_IF</span>

<span class="cp">{IF defined (pou:CAA.TaskUnlock)}</span>
    <span class="n">CAA.TaskUnlock</span><span class="p">(</span><span class="kc">FALSE</span><span class="p">);</span>
<span class="cp">{END_IF}</span>
</pre></div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For compatibility reasons with PLC targets, which do not yet support the <code class="docutils literal notranslate"><span class="pre">TaskLock</span></code> and <code class="docutils literal notranslate"><span class="pre">TaskUnlock</span></code> functions,
in the code snipped above we use the possibilities of conditional compiling via pragma statements.</p>
</div>
</section>
</section>


                        </div>
                    </div>
                </div>
            </div>

<footer id="footerWrapper">
    <div class="global-top-link to-top affix-top">
        <a href="#">
            <i class="zmdi zmdi-chevron-up"><span class="sr-only">top</span></i>
        </a>
    </div>
    <div class="inner-wrapper container-fluid">
        <div class="container">
            <div class="row">
                <div class="col-sm-12 col-footer-claim">
                    <div class="inner-wrapper">
                        <p class="claim" style="font-weight: 500;">
                            CODESYS Group | We <i>software</i> Automation.
                            <span class="info">
                                to software <br>
                                ['s&#594;ftw&#603;&#601;r] <br>
                                transitive verb <br>
                                __softwared/softwaring <br>
                                : to develop software <br>
                                // to software automation: to develop software for automation purposes
                            </span>
                        </p>
                    </div>
                </div>
                <div class="col-md-3 col-sm-6 col-footer-content">
                    <div class="frame frame-default frame-type-textmedia frame-layout-0 frame-space-before-none frame-space-after-default"
                         id="c12115">
                        <a id="c12116"></a>
                        <div class="ce-textpic ce-left ce-above fsc-textmedia layout-0">
                            <div class="ce-bodytext">
                                <p>The CODESYS Group is the manufacturer of CODESYS, the leading hardware-independent
                                    IEC 61131-3 automation software for developing and engineering controller
                                    applications.<br/>
                                    CODESYS&reg; is a registered trademark.
                                    </p>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-md-3 col-sm-6">
                    <address>
                        <div class="adr-name">CODESYS GmbH</div>
                        <div class="adr-responsive">A member of the CODESYS Group</div>
                        <div class="adr-location">Memminger Stra&szlig;e 151, 87439 Kempten</div>
                        <div class="adr-country">Germany</div>
                        <div class="adr-tel">Tel.:
                            <tcxspan tcxhref="+49831540310" title="Call  +49-831-54031-0 via 3CX"> +49-831-54031-0
                            </tcxspan>
                        </div>
                        <div class="adr-mail"><a href="javascript:linkTo_UnCryptMailto('hvdgoj5diajVxjyzntn9xjh');">info@codesys.com</a>
                        </div>
                    </address>
                </div>
                <div class="col-md-3 col-sm-6">
                    <div id="footerMenu">
                        <ul class="list-inline">
                            <li>
                                <a class="default" href="https://www.codesys.com/legal-notice.html">
                                    <span>Legal Notice</span>
                                </a>
                            </li>
                            <li>
                                <a class="default" href="https://www.codesys.com/privacy-policy.html">
                                    <span>Privacy Policy</span>
                                </a>
                            </li>
                        </ul>
                    </div>
                </div>
                <div class="col-md-3 col-sm-6 col-footer-shortcuts">
                    <a href="https://www.linkedin.com/company/codesys" target="_blank">
                        <i class="zmdi zmdi-hc-fw zmdi-linkedin-box"><span class="sr-only">LinkedIn</span></i>
                    </a>
                    <a href="https://www.youtube.com/channel/UC2hQMrlITlc-JpVanRnuYdA" target="_blank">
                        <i class="zmdi zmdi-hc-fw zmdi-youtube"><span class="sr-only">Youtube</span></i>
                    </a>
                    <a href="https://www.codesys.com/news-events/publications/codesys-rss-feeds.html" target="_blank">
                        <i class="zmdi zmdi-hc-fw zmdi-rss"><span class="sr-only">RSS</span></i>
                    </a>
                    <a href="https://www.codesys.com/download.html" target="_blank">
                        <i class="zmdi zmdi-hc-fw zmdi-download"><span class="sr-only">Downloads</span></i>
                    </a>
                    <a href="http://customers.codesys.com/" target="_blank">
                        <i class="zmdi zmdi-hc-fw zmdi-lock"><span class="sr-only">Login</span></i>
                    </a>
                    <a href="https://store.codesys.com/" target="_blank">
                        <i class="zmdi zmdi-hc-fw zmdi-shopping-cart"><span class="sr-only">CODESYS Store</span></i>
                    </a>
                </div>
            </div>
            <div class="copyright">
                &copy; 2022 CODESYS GmbH
                <small class="text-muted">
                    | A member of the CODESYS Group
                </small>
            </div>
        </div>
    </div>
</footer> 

        </section>

    </div>

  
    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'3.5.21.0 (Draft)',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:false
        };
    </script>
    <script type="text/javascript" src="_static/documentation_options.js"></script>
    
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/sphinx_highlight.js"></script>
  
    <script type="text/javascript" src="_static/js/theme.js"></script>

</body>
</html>